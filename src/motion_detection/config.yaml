# Motion Detection Configuration - Bird-Focused Version
# This config file contains only the variables that are actually used by the codebase
# OPTIMIZED FOR BIRD DETECTION: Reduced background noise sensitivity, increased filtering for bird-sized objects

# ===============================
# LOGGING CONFIGURATION
# ===============================
logging:
  log_level: "debug"              # Options: "trace", "debug", "info", "warn", "error", "critical", "off"
  log_to_file: true               # Enable logging to file
  log_file_path: "birdsofplay.log" # Path to log file

# ===============================
# IMAGE PROCESSING
# ===============================
processing_mode: "grayscale"      # Color processing mode: "grayscale", "hsv", "rgb", "ycrcb"

# Image Preprocessing
contrast_enhancement: true        # Apply CLAHE contrast enhancement
clahe_clip_limit: 3.0            # CLAHE clip limit (1.0-5.0, higher = more contrast)
clahe_tile_size: 8               # CLAHE tile size (4-16, must be even)

# Blur Parameters - Increased to reduce background noise sensitivity
gaussian_blur_size: 11           # Gaussian blur kernel size (3-15, odd numbers only) - INCREASED to reduce noise
median_blur_size: 7              # Median blur kernel size (3-15, odd numbers only) - INCREASED to reduce noise
bilateral_d: 19                  # Bilateral filter diameter (5-25) - INCREASED for better noise reduction
bilateral_sigma_color: 100       # Bilateral filter sigma color (10-150) - INCREASED for smoother backgrounds
bilateral_sigma_space: 100       # Bilateral filter sigma space (10-150) - INCREASED for smoother backgrounds

# ===============================
# MOTION DETECTION
# ===============================
background_subtraction: true     # Enable background subtraction
max_threshold: 255               # Maximum threshold value

# ===============================
# MORPHOLOGICAL OPERATIONS
# ===============================
morphology: true                 # Enable morphological operations
morph_kernel_size: 7            # Kernel size for morphological operations (3-15, odd numbers)
morph_close: true               # Fill holes in objects
morph_open: true                # Remove noise blobs
dilation: true                  # Expand objects
erosion: false                  # Shrink objects

# ===============================
# CONTOUR PROCESSING
# ===============================
convex_hull: true               # Apply convex hull to contours
contour_approximation: true     # Simplify contour shapes
contour_epsilon_factor: 0.03    # Approximation accuracy (0.01-0.1, lower = more accurate)
contour_filtering: true         # Enable contour filtering

# Contour Filtering Parameters - Tuned for bird-sized objects
min_contour_area: 800           # Minimum contour area to keep (INCREASED from 200 to filter small noise)
max_contour_aspect_ratio: 2.5   # Maximum width/height ratio (DECREASED for more compact bird shapes)
min_contour_solidity: 0.5       # Minimum solidity ratio (INCREASED to filter irregular background noise)

# ===============================
# DATA COLLECTION
# ===============================
data_collection: true           # Enable data collection and saving
cleanup_old_data: true          # Delete old data on startup
image_format: "png"             # Format for saving images
min_tracking_confidence: 0.75   # Minimum confidence for tracking (INCREASED to filter low-confidence detections)

# ===============================
# REGION CONSOLIDATION
# ===============================
# Consolidation parameters for grouping nearby motion detections - Tuned for birds
max_distance_threshold: 150.0        # Max distance between objects to group (INCREASED to capture bird flight patterns)
min_objects_per_region: 10           # Min objects to form a region (BALANCED for meaningful bird movement)
overlap_threshold: 0.3               # Min overlap ratio to merge regions (INCREASED for stricter merging)
grid_cell_size: 120.0                # Cell size for grid-based grouping (REDUCED for finer tracking)
max_frames_without_update: 5         # Max frames before removing region (REDUCED to remove transient noise faster)
min_region_area: 3000.0              # Min area for consolidated region (BALANCED for bird movement detection)
max_region_area: 1000000.0           # Max area for consolidated region (640x640 = 409,600)
region_expansion_factor: 1.1         # Factor to expand bounding box
push: 640         # Ideal region size for YOLOv11
size_tolerance_percent: 30           # Size tolerance percentage (regions within this % of ideal size are kept as-is)

# MongoDB Configuration
mongodb_uri: "mongodb://localhost:27017"
database_name: "birds_of_play"
collection_prefix: "motion_tracking"
save_only_consolidated_regions: true  # Only save frames that have consolidated regions (reduces noise)
